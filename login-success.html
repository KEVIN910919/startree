<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <title>登入完成</title>
</head>
<body style="background:red;color:white;font-size:24px;">
  <h1>這是新版本測試頁</h1>
  <pre id="debug"></pre>

  <script>
    const dbg = (t) => {
      document.getElementById("debug").textContent += t + "\n";
    };

    const token = new URLSearchParams(location.search).get("token");
    dbg("收到 token = " + token);

    if(token){
      if(window.opener){
        dbg("找到 opener，送出 postMessage");
        window.opener.postMessage({ token }, "*");
        dbg("已送出，不自動關閉");
      }else{
        dbg("❌ 找不到 opener");
      }
    }else{
      dbg("❌ 沒有 token");
    }
  </script>
</body>
</html>
